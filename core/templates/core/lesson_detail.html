{% extends 'core/base.html' %}

{% block content %}
  <article class="bg-white p-6 rounded shadow">
    <h2 class="text-2xl font-bold">{{ article.title }}</h2>
    <p class="text-sm text-gray-500 mt-1">Category: {{ article.get_category_display }}</p>
    <div class="mt-4">
      {{ article.content|linebreaks }}
    </div>

    {% if article.video %}
      <div class="mt-4">
        <video controls class="w-full rounded"> <source src="{{ article.video.url }}"></video>
      </div>
    {% endif %}

    <div class="mt-6 flex gap-3">
      <button x-data x-on:click="$dispatch('open-quiz')" class="px-4 py-2 bg-[color:var(--leaf)] text-white rounded">Test Yourself</button>
      {% if article.pdf %}
        <a href="{{ article.pdf.url }}" class="px-4 py-2 border rounded">Download Guide (PDF)</a>
      {% endif %}
    </div>

    {% if quiz %}
      <!-- Quiz placeholder/modal trigger -->
      <div x-data @open-quiz.window="document.getElementById('quiz-modal').classList.remove('hidden')">
        <div id="quiz-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div class="bg-white rounded p-6 w-11/12 md:w-2/3">
            <h3 class="font-semibold">Quiz: {{ quiz.title }}</h3>
            <div id="quiz-app" class="mt-4">
              <!-- JS will fetch /quizzes/api/<id>/ -->
              <p class="text-sm text-gray-600">Loading quiz...</p>
            </div>
            <div class="mt-4 text-right">
              <button onclick="document.getElementById('quiz-modal').classList.add('hidden')" class="px-3 py-1 border rounded">Close</button>
            </div>
          </div>
        </div>
      </div>
    {% endif %}

  </article>

{% endblock %}
