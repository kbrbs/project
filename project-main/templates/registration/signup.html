{% extends 'core/base.html' %}

{% block content %}
{% load static %}
<style>
  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .slide-up-animation {
    animation: slideUp 0.6s ease-out;
  }
  
  /* Override base.html main container styling for this page */
  main {
    max-width: 100% !important;
    padding: 0 !important;
  }
</style>

<div class="fixed inset-0 top-[72px] flex items-center justify-center p-4">
  <div class="w-full max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 bg-white rounded-2xl overflow-hidden shadow-2xl slide-up-animation">
    <!-- Left illustration / marketing -->
    <div class="hidden md:flex flex-col items-center justify-center bg-gradient-to-br from-[color:var(--cream)] to-white p-12 relative">
      <!-- Background Image -->
      <img src="{% static 'pictures/pic2.jpg' %}" alt="Signup Illustration" class="absolute inset-0 w-full h-full object-cover">
      
      <div class="w-full max-w-sm relative z-10">
        <!-- Logo -->
        <div class="w-full h-60 mb-6 flex items-center justify-center">
          <img src="{% static 'pictures/main logo.png' %}" alt="Logo" class="w-full h-full object-contain">
        </div>

        <h2 class="text-2xl font-bold text-white">Create your student account</h2>
        <p class="mt-3 text-white">Sign up to save progress, earn badges, and join quizzes. It's quick and free.</p>
      </div>
    </div>

    <div class="p-8 flex items-center justify-center">
      <div class="w-full max-w-md">
        <h3 class="text-2xl font-extrabold mb-2">Sign up</h3>
        <p class="text-sm text-gray-500 mb-6">Create an account to save your progress and participate in quizzes.</p>

        <form method="post" class="space-y-4">
          {% csrf_token %}

          <div>
            <label for="id_full_name" class="block text-sm font-medium text-gray-700">Full name</label>
            <input id="id_full_name" name="full_name" type="text" value="{{ form.full_name.value|default_if_none:'' }}" required class="mt-1 block w-full rounded-md border-gray-200 shadow-sm px-3 py-2 focus:ring-2 focus:ring-[color:var(--leaf)]" />
            {% if form.full_name.errors %}
              <p class="text-sm text-red-600 mt-1">{{ form.full_name.errors.0 }}</p>
            {% endif %}
          </div>

          <div>
            <label for="id_username" class="block text-sm font-medium text-gray-700">Username</label>
            <input id="id_username" name="username" type="text" value="{{ form.username.value|default_if_none:'' }}" required class="mt-1 block w-full rounded-md border-gray-200 shadow-sm px-3 py-2 focus:ring-2 focus:ring-[color:var(--leaf)]" />
            {% if form.username.errors %}
              <p class="text-sm text-red-600 mt-1">{{ form.username.errors.0 }}</p>
            {% endif %}
          </div>

          <div>
            <label for="id_email" class="block text-sm font-medium text-gray-700">Email</label>
            <input id="id_email" name="email" type="email" value="{{ form.email.value|default_if_none:'' }}" required class="mt-1 block w-full rounded-md border-gray-200 shadow-sm px-3 py-2 focus:ring-2 focus:ring-[color:var(--leaf)]" />
            {% if form.email.errors %}
              <p class="text-sm text-red-600 mt-1">{{ form.email.errors.0 }}</p>
            {% endif %}
          </div>

          <div>
            <label for="id_birthday" class="block text-sm font-medium text-gray-700">Birthday</label>
            <input id="id_birthday" name="birthday" type="date" value="{{ form.birthday.value|default_if_none:'' }}" required class="mt-1 block w-full rounded-md border-gray-200 shadow-sm px-3 py-2 focus:ring-2 focus:ring-[color:var(--leaf)]" />
            {% if form.birthday.errors %}
              <p class="text-sm text-red-600 mt-1">{{ form.birthday.errors.0 }}</p>
            {% endif %}
          </div>

          <div>
            <label for="id_grade" class="block text-sm font-medium text-gray-700">Grade level</label>
            <select id="id_grade" name="grade" required class="mt-1 block w-full rounded-md border-gray-200 shadow-sm px-3 py-2 focus:ring-2 focus:ring-[color:var(--leaf)]">
              {% for val, label in form.fields.grade.choices %}
                <option value="{{ val }}" {% if form.grade.value == val %}selected{% endif %}>{{ label }}</option>
              {% endfor %}
            </select>
            {% if form.grade.errors %}
              <p class="text-sm text-red-600 mt-1">{{ form.grade.errors.0 }}</p>
            {% endif %}
          </div>

          <div>
            <label for="id_age" class="block text-sm font-medium text-gray-700">Age</label>
            <input id="id_age" name="age" type="text" readonly class="mt-1 block w-full rounded-md border-gray-200 bg-gray-50 shadow-sm px-3 py-2" />
          </div>

          <div>
            <button type="submit" class="w-full py-3 rounded-md bg-[color:var(--leaf)] text-white font-semibold hover:opacity-90">Sign up</button>
          </div>
        </form>
        <script>
          // compute age from birthday input
          function computeAge(dob) {
            if (!dob) return '';
            const b = new Date(dob);
            if (isNaN(b)) return '';
            const today = new Date();
            let age = today.getFullYear() - b.getFullYear();
            const m = today.getMonth() - b.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < b.getDate())) age--;
            return age;
          }
          const dobInput = document.getElementById('id_birthday');
          const ageInput = document.getElementById('id_age');
          function updateAge(){ ageInput.value = computeAge(dobInput.value); }
          if (dobInput){ dobInput.addEventListener('change', updateAge); updateAge(); }
        </script>

        <div class="mt-4 text-center text-sm">
          <span class="text-gray-600">Already have an account?</span>
          <a href="{% url 'login' %}" class="text-[color:var(--leaf)] font-medium ml-2">Log in</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
