{% extends 'core/base.html' %}

{% block content %}
  <h2 class="text-2xl font-bold">{{ quiz.title }}</h2>
  <div id="quiz-root" class="mt-4 bg-white p-6 rounded shadow">
    <p class="text-sm text-gray-600">The quiz will load via the JSON API and render a simple interactive UI.</p>
    <div id="quiz-app" class="mt-4"></div>
  </div>

  <script>
    async function loadQuiz(){
      const res = await fetch(`/quizzes/api/{{ quiz.id }}/`);
      const data = await res.json();
      const container = document.getElementById('quiz-app');
      container.innerHTML = '';

      data.questions.forEach((q, idx) => {
        const card = document.createElement('div');
        card.className = 'p-3 border rounded mb-3';
        const qtitle = document.createElement('div'); qtitle.textContent = (idx+1) + '. ' + q.text;
        card.appendChild(qtitle);
        q.choices.forEach(c => {
          const label = document.createElement('label');
          label.className = 'block mt-2';
          const input = document.createElement('input');
          input.type = 'radio';
          input.name = 'q-' + q.id;
          input.value = c.id;
          label.appendChild(input);
          label.appendChild(document.createTextNode(' ' + c.text));
          card.appendChild(label);
        });
        container.appendChild(card);
      });

      const submit = document.createElement('button');
      submit.className = 'px-3 py-2 bg-[color:var(--leaf)] text-white rounded';
      submit.textContent = 'Submit';
      submit.onclick = () => alert('Quiz submission placeholder — implement scoring and POST to record progress.');
      container.appendChild(submit);
    }
    loadQuiz().catch(console.error);
  </script>

{% endblock %}
{% extends 'core/base.html' %}

{% block content %}
  <h2 class="text-2xl font-bold">{{ quiz.title }}</h2>
  <p class="text-sm text-gray-600">Interactive quiz placeholder — this page uses the JSON API to fetch questions and run a small JS quiz UI.</p>

  <div id="quiz-root" class="mt-4 bg-white p-4 rounded shadow">
    <p class="text-gray-600">Loading...</p>
  </div>

  <script>
    (function(){
      const root = document.getElementById('quiz-root');
      fetch('/quizzes/api/{{ quiz.id }}/')
        .then(r=>r.json())
        .then(data=>{
          root.innerHTML = '';
          data.questions.forEach((q, idx)=>{
            const qdiv = document.createElement('div');
            qdiv.className = 'mb-4';
            qdiv.innerHTML = `<p class="font-semibold">${idx+1}. ${q.text}</p>`;
            q.choices.forEach(c=>{
              const btn = document.createElement('button');
              btn.className = 'mt-2 mr-2 px-3 py-1 border rounded';
              btn.textContent = c.text;
              btn.onclick = ()=>{ alert('Answer recorded (placeholder)'); };
              qdiv.appendChild(btn);
            });
            root.appendChild(qdiv);
          });
        })
        .catch(err=>{ root.innerHTML = '<p class="text-red-500">Unable to load quiz.</p>'; });
    })();
  </script>

{% endblock %}
